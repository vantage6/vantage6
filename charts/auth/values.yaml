keycloak:
  postgresql:
    enabled: true
    auth:
      postgresPassword: postgres
      password: keycloak
      database: keycloak
  auth:
    adminUser: admin
    adminPassword: admin
  keycloakConfigCli:
    enabled: true
    configuration:
      realm:
        realm: vantage6
        enabled: true
        requiredActions:
          - alias: CONFIGURE_TOTP
            name: Configure OTP
            providerId: CONFIGURE_TOTP
            enabled: true
            # by setting defaultAction to true, the user will be prompted to configure
            # OTP on first login
            defaultAction: true
            priority: 10
        users:
          - username: admin
            enabled: true
            credentials:
              - type: password
                value: admin
            requiredActions:
              - CONFIGURE_TOTP
              - UPDATE_PASSWORD
          - username: service-account-backend-admin-client
            enabled: true
            serviceAccountClientId: backend-admin-client
            clientRoles:
              realm-management:
                - view-users
                - manage-users
        clients:
          - clientId: public_client
            publicClient: true
            redirectUris:
              - "*"
            webOrigins:
              - "*"
            protocolMappers:
              - name: vantage6_client_type
                protocol: openid-connect
                protocolMapper: oidc-hardcoded-claim-mapper
                consentRequired: false
                config:
                  claim.name: vantage6_client_type
                  claim.value: user
                  introspection.token.claim: true
                  userinfo.token.claim: true
                  id.token.claim: true
                  access.token.claim: true
          - clientId: backend-admin-client
            publicClient: false
            redirectUris:
              - "*"
            secret: myadminclientsecret
            serviceAccountsEnabled: true
            standardFlowEnabled: false
          - clientId: node-client
            publicClient: false
            redirectUris:
              - "*"
            secret: mynodeclientsecret
            directAccessGrantsEnabled: true
            standardFlowEnabled: false
            protocolMappers:
              - name: vantage6_client_type
                protocol: openid-connect
                protocolMapper: oidc-hardcoded-claim-mapper
                consentRequired: false
                config:
                  claim.name: vantage6_client_type
                  claim.value: node
                  introspection.token.claim: true
                  userinfo.token.claim: true
                  id.token.claim: true
                  access.token.claim: true
