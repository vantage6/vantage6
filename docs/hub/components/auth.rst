.. _hub-admin-guide-auth:

Authentication service
=======================

The authentication service is responsible for authenticating users and nodes. It uses
the popular `Keycloak <https://www.keycloak.org/>`_ service to handle authentication
within the vantage6 infrastructure.

Install
-------

.. note::

    This installation is also run automatically whenever you start the authentication
    service with ``v6 auth start`` or via ``v6 hub start``.

The Helm chart for the Keycloak authentication service is based on the
`Keycloak Operator <https://www.keycloak.org/operator/installation>`_, which is
Keycloak's recommended way to deploy Keycloak in a Kubernetes cluster. To use it,
you need to install custom resource definitions (CRDs) for the Keycloak Operator. The
CRDs are custom kubernetes resources that specify how Keycloak should be deployed.
You can install the CRDs using the following command:

.. code-block:: bash

    vantage6 auth install-keycloak

Configure
---------

The Keycloak operator requires a YAML file to configure the Keycloak instance. This file
is generated by the ``v6 hub new`` :ref:`command <use-hub>`.

Below, we list all possible configuration options. You can download this file here:
:download:`auth_config.yaml <yaml/auth_config.yaml>`

.. _auth-configuration-file:

.. literalinclude :: yaml/auth_config.yaml
    :language: yaml